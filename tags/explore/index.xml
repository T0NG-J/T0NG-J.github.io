<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Explore on TongJ-Writeups</title>
    <link>https://t0ng-j.github.io/tags/explore/</link>
    <description>Recent content in Explore on TongJ-Writeups</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>en-us</language>
    <lastBuildDate>Sat, 13 Nov 2021 19:44:20 +0700</lastBuildDate><atom:link href="https://t0ng-j.github.io/tags/explore/index.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>HTB - Explore</title>
      <link>https://t0ng-j.github.io/posts/htb-explore/</link>
      <pubDate>Sat, 13 Nov 2021 19:44:20 +0700</pubDate>
      
      <guid>https://t0ng-j.github.io/posts/htb-explore/</guid>
      <description>HTB - Explore Android - Easy IP = 10.10.10.247
Enumeration Likes always run Nmap scan for opening port
Nmap: sudo nmap -sSVC -p- explore.htb -oA nmap/explore
   Port Service     2222/tcp SSH-2.0-SSH Server - Banana Studio   5555/tcp freeciv   42135/tcp ES File Explorer Name Response httpd   42207/tcp unknown   59777/tcp Bukkit JSONAPI httpd for Minecraft game server 3.6.0     Freeciv, ES File Explorer, and Bukkit JSONAPI httpd is quite interesting then I research some CVE, vulnerabilities about them and I found the FreeCIV Arbitrary Code Execution and ES File Explorer - Arbitrary File Read (the FreeCIV exploit can get root maybe this was privilege escalation part)</description>
      <content>&lt;h1 id=&#34;htb---explore&#34;&gt;HTB - Explore&lt;/h1&gt;
&lt;h2 id=&#34;android---easy&#34;&gt;Android - Easy&lt;/h2&gt;
&lt;p&gt;IP = 10.10.10.247&lt;/p&gt;
&lt;h2 id=&#34;enumeration&#34;&gt;Enumeration&lt;/h2&gt;
&lt;p&gt;Likes always run Nmap scan for opening port&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Nmap:&lt;/strong&gt; &lt;code&gt;sudo nmap -sSVC -p- explore.htb -oA nmap/explore&lt;/code&gt;&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Port&lt;/th&gt;
&lt;th style=&#34;text-align:center&#34;&gt;Service&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;2222/tcp&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;SSH-2.0-SSH Server - Banana Studio&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;5555/tcp&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;freeciv&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;42135/tcp&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;ES File Explorer Name Response httpd&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;42207/tcp&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;unknown&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;59777/tcp&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;Bukkit JSONAPI httpd for Minecraft game server 3.6.0&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;&lt;img src=&#34;https://user-images.githubusercontent.com/58801547/141645038-e445b2b3-8bd2-4e18-8169-cc7c7034c81d.png&#34; alt=&#34;nmap1&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://user-images.githubusercontent.com/58801547/141645389-ade36ba0-d99a-4ecf-acbb-8a08efdc88ec.png&#34; alt=&#34;nmap2&#34;&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Freeciv, ES File Explorer, and Bukkit JSONAPI httpd is quite interesting then I research some CVE, vulnerabilities about
them and I found the &lt;strong&gt;FreeCIV Arbitrary Code Execution&lt;/strong&gt; and &lt;strong&gt;ES File Explorer - Arbitrary File Read&lt;/strong&gt; (the FreeCIV exploit can get root maybe this was privilege escalation part)&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;strong&gt;Metasploit:&lt;/strong&gt; &lt;code&gt;Module ES File Explorer Open Port&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;This module was created from &lt;a href=&#34;https://www.cvedetails.com/cve/CVE-2019-6447/&#34;&gt;CVE-2019-6447&lt;/a&gt;,&lt;strong&gt;ES File Explorer - Arbitrary File Read&lt;/strong&gt; So I use it to get more information on this machine&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://user-images.githubusercontent.com/58801547/141645965-03349cca-77f3-4e5a-bac7-b55dcff8ba86.png&#34; alt=&#34;met1&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://user-images.githubusercontent.com/58801547/141646692-b8ade327-3f15-4932-9d67-05f8b57af7d4.png&#34; alt=&#34;met2&#34;&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;After listing some files I found the &lt;code&gt;creds.jpg&lt;/code&gt; file, looks like it contains user credentials, I access that path in browser &lt;code&gt;http://explore.htb:59777/storage/emulated/0/DCIM/creds.jpg&lt;/code&gt; then I got some user credential&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;img src=&#34;https://user-images.githubusercontent.com/58801547/141646875-bfb3f5c8-6b28-4e20-a343-aaff46dcd5f9.png&#34; alt=&#34;cred&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;SSH:&lt;/strong&gt; &lt;code&gt;ssh kristi@explore.htb -p 2222&lt;/code&gt; with &lt;code&gt;Kristi:Kr1sT!5h@Rp3xPl0r3!&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://user-images.githubusercontent.com/58801547/141647437-4efc2217-512b-4527-bf56-e29244a98619.png&#34; alt=&#34;ssh&#34;&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;I try &lt;code&gt;SSH&lt;/code&gt; with the Kristi user and got it now look for &lt;code&gt;user.txt&lt;/code&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;img src=&#34;https://user-images.githubusercontent.com/58801547/141647685-4cc459b8-8fbd-40e7-9d7a-b1786bf40956.png&#34; alt=&#34;user.txt&#34;&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;I list all files and found the link directory name &lt;code&gt;sdcard&lt;/code&gt; link to primary storage of the device and then found &lt;code&gt;user.txt&lt;/code&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&#34;exploitation--privilege-escalation&#34;&gt;Exploitation &amp;amp; Privilege Escalation&lt;/h2&gt;
&lt;p&gt;Now I try the Freeciv &lt;a href=&#34;https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2010-2445&#34;&gt;CVE-2010-2445&lt;/a&gt; that I found early in the enumeration part I try &lt;code&gt;ADB&lt;/code&gt; connect from my kali -&amp;gt; machine and it does not work and the remote machine does not have &lt;code&gt;ADB&lt;/code&gt; too&lt;/p&gt;
&lt;p&gt;So I use Tunneling to access the &lt;code&gt;5555&lt;/code&gt; ADB port with this I can access remote machine specific port through my local machine&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://user-images.githubusercontent.com/58801547/141648285-4e906813-a3b7-417e-a348-d25d5f3b15a6.png&#34; alt=&#34;tunneling&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://user-images.githubusercontent.com/58801547/141648759-dd55387e-26e4-4de6-9d5d-b5281869a5a9.png&#34; alt=&#34;root&#34;&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Now I can use &lt;code&gt;ADB&lt;/code&gt; to connect and get shell user since it doesn&amp;rsquo;t require any authentication, I just &lt;code&gt;su&lt;/code&gt; to login as root and got &lt;code&gt;root.txt&lt;/code&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&#34;reference&#34;&gt;Reference&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://www.rapid7.com/db/modules/auxiliary/scanner/http/es_file_explorer_open_port/&#34;&gt;https://www.rapid7.com/db/modules/auxiliary/scanner/http/es_file_explorer_open_port/&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://labs.f-secure.com/blog/hackin-around-the-christmas-tree/&#34;&gt;https://labs.f-secure.com/blog/hackin-around-the-christmas-tree/&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://packetstormsecurity.com/files/163311/Android-2.0-FreeCIV-Arbitrary-Code-Execution.html&#34;&gt;https://packetstormsecurity.com/files/163311/Android-2.0-FreeCIV-Arbitrary-Code-Execution.html&lt;/a&gt;&lt;/p&gt;
</content>
    </item>
    
  </channel>
</rss>
