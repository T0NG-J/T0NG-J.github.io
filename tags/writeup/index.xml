<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Writeup on TongJ-Writeups</title>
    <link>https://tongj.github.io/tags/writeup/</link>
    <description>Recent content in Writeup on TongJ-Writeups</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>en-us</language>
    <lastBuildDate>Fri, 05 Nov 2021 19:39:05 +0700</lastBuildDate><atom:link href="https://tongj.github.io/tags/writeup/index.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>HTB - Cap</title>
      <link>https://tongj.github.io/posts/htb-cap/</link>
      <pubDate>Fri, 05 Nov 2021 19:39:05 +0700</pubDate>
      
      <guid>https://tongj.github.io/posts/htb-cap/</guid>
      <description>HTB - Cap  Linux - Easy IP = 10.10.10.245
First Add hostname to /etc/hosts file, name cap.htb
Enumuration Nmap: sudo nmap -A cap.htb
Use Nmap scan for the open ports, Here is some service information and web-server banner
 21 ftp vsfp 3.0.3 22 ssh 80 http gunicorn  (gunicorn is a python Web Server Gateway Interface (WSGI) use for UNIX system).
Somehow maybe the FTP and gunicorn have the vulnerability, after googling around I didn&amp;rsquo;t find any critical or High vulnerability that can lead to exploit (trying FTP with anonymous login doesn&amp;rsquo;t works too).</description>
      <content>&lt;h1 id=&#34;htb---cap&#34;&gt;HTB - Cap&lt;/h1&gt;
&lt;hr&gt;
&lt;h2 id=&#34;linux---easy&#34;&gt;Linux - Easy&lt;/h2&gt;
&lt;p&gt;IP = 10.10.10.245&lt;/p&gt;
&lt;p&gt;First Add hostname to &lt;code&gt;/etc/hosts&lt;/code&gt; file, name &lt;strong&gt;cap.htb&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://user-images.githubusercontent.com/58801547/134887782-75fefd0e-13eb-4d01-8aa4-deccc54761d7.png&#34; alt=&#34;image&#34;&gt;&lt;/p&gt;
&lt;h2 id=&#34;enumuration&#34;&gt;Enumuration&lt;/h2&gt;
&lt;p&gt;&lt;strong&gt;Nmap:&lt;/strong&gt; &lt;code&gt;sudo nmap -A cap.htb&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;Use Nmap scan for the open ports, 
Here is some service information and web-server banner&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;21  ftp vsfp 3.0.3&lt;/li&gt;
&lt;li&gt;22  ssh&lt;/li&gt;
&lt;li&gt;80  http gunicorn&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;(gunicorn is a python Web Server Gateway Interface (WSGI) use for UNIX system).&lt;/p&gt;
&lt;p&gt;Somehow maybe the FTP and gunicorn have the vulnerability, after googling around I didn&amp;rsquo;t find any critical or High vulnerability that can lead to exploit (trying FTP with anonymous login doesn&amp;rsquo;t works too).&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://user-images.githubusercontent.com/58801547/134888516-fa417f77-fe02-40b7-a93a-4395f9fc0613.png&#34; alt=&#34;image&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://user-images.githubusercontent.com/58801547/134891674-7d8e991a-5c38-4ca7-90bd-ac7902c3f365.png&#34; alt=&#34;image&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Gobuster:&lt;/strong&gt; &lt;code&gt;gobuster dir -u http://cap.htb -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -t 20 -z&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;Enum directory of the target with gobuster dir mode, found interesting directory and now I should go to the web and testing some workflow or how this web-app works.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://user-images.githubusercontent.com/58801547/134892923-ea7602b9-a1f9-45a9-9f8c-bf704b5f3f30.png&#34; alt=&#34;image&#34;&gt;&lt;/p&gt;
&lt;p&gt;After discovery how this web-application works the data page contain logging of packet and store to pcap file in order and index it seem to have &lt;strong&gt;broken access control&lt;/strong&gt; here, then I try to change index of data page by increase, decrease it and found this 0.pcap file as image below.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://user-images.githubusercontent.com/58801547/134893920-02c85de2-5fb5-4427-9475-193e9df7e1f1.png&#34; alt=&#34;image&#34;&gt;
&lt;img src=&#34;https://user-images.githubusercontent.com/58801547/134894615-948e098f-a168-4528-8685-5820cadd1c1d.png&#34; alt=&#34;image&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Wireshark:&lt;/strong&gt; 
Using wireshark to analyze the packet and found the FTP credential of &lt;strong&gt;nathan&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://user-images.githubusercontent.com/58801547/134895350-7640623b-3c85-4308-89be-903b821dc321.png&#34; alt=&#34;image&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Optional:&lt;/strong&gt; using tshark to extract the information of packet by filtering&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Tshark:&lt;/strong&gt; &lt;code&gt;tshark -r 0.pcap -Y ftp&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://user-images.githubusercontent.com/58801547/134895531-20944d28-0636-4ccb-bddd-f05b40b801da.png&#34; alt=&#34;image&#34;&gt;&lt;/p&gt;
&lt;h2 id=&#34;exploitation--privilege-escalation&#34;&gt;Exploitation &amp;amp; Privilege Escalation&lt;/h2&gt;
&lt;p&gt;Now I got the FTP credential but it should try login on other places too such as, &lt;strong&gt;SSH&lt;/strong&gt; and then got the user :)&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://user-images.githubusercontent.com/58801547/134896003-c93b0f0f-b39f-4860-b00e-495cfcad491f.png&#34; alt=&#34;image&#34;&gt;&lt;/p&gt;
&lt;p&gt;Look like &lt;strong&gt;nathan&lt;/strong&gt; doesn&amp;rsquo;t have any sudo permission so I use &lt;strong&gt;linpeas&lt;/strong&gt; to enumuration more information so I can escalate to root&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://user-images.githubusercontent.com/58801547/134896243-8603cc22-0f48-44fb-85bd-4cb5b2294553.png&#34; alt=&#34;image&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Scp:&lt;/strong&gt; &lt;code&gt;scp filename user@remotehost:location&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;Since I know the &lt;strong&gt;ssh&lt;/strong&gt; user credential I just use &lt;strong&gt;scp&lt;/strong&gt; to transfer file between &lt;strong&gt;local&lt;/strong&gt; and &lt;strong&gt;remote machine&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://user-images.githubusercontent.com/58801547/134896685-f356e4fa-9177-4a0c-a5dd-a6bc2f87ddb4.png&#34; alt=&#34;image&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Linpeas:&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Now run the &lt;strong&gt;linpeas.sh&lt;/strong&gt; then I got some information, it obvious this machine have capability of &lt;strong&gt;cap_setuid&lt;/strong&gt; function and can access through &lt;strong&gt;python&lt;/strong&gt; then I can escalate to root with just basic python script&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://user-images.githubusercontent.com/58801547/134897124-42c308a6-ed11-4f34-9902-580a4b1d25e8.png&#34; alt=&#34;image&#34;&gt;&lt;/p&gt;
&lt;p&gt;Run &lt;code&gt;python3 -c &#39;import os; os.setuid(0); os.system(&amp;quot;/bin/bash -i&amp;quot;)&#39;&lt;/code&gt; and then get rooted üê±‚Äçüë§ quiet easy right?&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://user-images.githubusercontent.com/58801547/134898083-597037e8-020e-42ca-8956-ce3b1e1f7415.png&#34; alt=&#34;image&#34;&gt;&lt;/p&gt;
&lt;hr&gt;
</content>
    </item>
    
  </channel>
</rss>
